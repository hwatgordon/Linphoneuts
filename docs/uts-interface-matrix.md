# Linphone UTS interface matrix (main)

## Summary

| Kind | Total APIs | iOS coverage | Android coverage | Both platforms |
| --- | --- | --- | --- | --- |
| Methods | 11 | 11 | 11 | 11 |
| Events | 6 | 6 | 6 | 6 |
| Constants | 1 | 1 | 1 | 1 |

- All method exports ultimately delegate to `LinphoneManager` stubs on each platform, which are flagged with TODOs to integrate the real Linphone SDK workflows.
- Event delivery relies on `setEventCallback` (available on iOS and Android) with Android also exposing `setEventListener` for compatibility with older runtimes.

## Method APIs

| API | Signature | iOS | Android | Notes |
| --- | --- | --- | --- | --- |
| `init` | `init(config?: LinphoneConfig): Promise<boolean>` | ✅ | ✅ | iOS: `LinphoneBridge.initialize` (uni_modules/utssdk/app-ios/src/LinphoneBridge.swift#L28-L63) → `LinphoneManager.initialize` (uni_modules/utssdk/app-ios/src/LinphoneManager.swift#L39-L45).<br>Android: `LinphoneBridge.initialize` (uni_modules/utssdk/app-android/src/main/java/com/utssdk/linphone/LinphoneBridge.kt#L28-L64) → `LinphoneManager.initialize` (uni_modules/utssdk/app-android/src/main/java/com/utssdk/linphone/LinphoneManager.kt#L49-L56). TODO: native Linphone SDK wiring pending on both platforms. |
| `register` | `register(): void` | ✅ | ✅ | iOS: `LinphoneBridge.register` (uni_modules/utssdk/app-ios/src/LinphoneBridge.swift#L73-L75) → `LinphoneManager.register` (uni_modules/utssdk/app-ios/src/LinphoneManager.swift#L48-L57).<br>Android: `LinphoneBridge.register` (uni_modules/utssdk/app-android/src/main/java/com/utssdk/linphone/LinphoneBridge.kt#L82-L84) → `LinphoneManager.register` (uni_modules/utssdk/app-android/src/main/java/com/utssdk/linphone/LinphoneManager.kt#L59-L64). TODO: replace simulated registration with real SDK calls. |
| `unregister` | `unregister(): void` | ✅ | ✅ | iOS: `LinphoneBridge.unregister` (uni_modules/utssdk/app-ios/src/LinphoneBridge.swift#L77-L79) → `LinphoneManager.unregister` (uni_modules/utssdk/app-ios/src/LinphoneManager.swift#L61-L66).<br>Android: `LinphoneBridge.unregister` (uni_modules/utssdk/app-android/src/main/java/com/utssdk/linphone/LinphoneBridge.kt#L86-L89) → `LinphoneManager.unregister` (uni_modules/utssdk/app-android/src/main/java/com/utssdk/linphone/LinphoneManager.kt#L67-L70). |
| `dial` | `dial(number: string): void` | ✅ | ✅ | iOS: `LinphoneBridge.callDial` (uni_modules/utssdk/app-ios/src/LinphoneBridge.swift#L81-L83) → `LinphoneManager.dial` (uni_modules/utssdk/app-ios/src/LinphoneManager.swift#L69-L80).<br>Android: `LinphoneBridge.callDial` (uni_modules/utssdk/app-android/src/main/java/com/utssdk/linphone/LinphoneBridge.kt#L92-L94) → `LinphoneManager.dial` (uni_modules/utssdk/app-android/src/main/java/com/utssdk/linphone/LinphoneManager.kt#L73-L79). TODO: dial flow still simulated. |
| `hangup` | `hangup(): void` | ✅ | ✅ | iOS: `LinphoneBridge.callHangup` (uni_modules/utssdk/app-ios/src/LinphoneBridge.swift#L85-L87) → `LinphoneManager.hangup` (uni_modules/utssdk/app-ios/src/LinphoneManager.swift#L84-L90).<br>Android: `LinphoneBridge.callHangup` (uni_modules/utssdk/app-android/src/main/java/com/utssdk/linphone/LinphoneBridge.kt#L96-L99) → `LinphoneManager.hangup` (uni_modules/utssdk/app-android/src/main/java/com/utssdk/linphone/LinphoneManager.kt#L91-L95). |
| `answer` | `answer(): void` | ✅ | ✅ | iOS: `LinphoneBridge.callAnswer` (uni_modules/utssdk/app-ios/src/LinphoneBridge.swift#L89-L91) → `LinphoneManager.answer` (uni_modules/utssdk/app-ios/src/LinphoneManager.swift#L93-L99).<br>Android: `LinphoneBridge.callAnswer` (uni_modules/utssdk/app-android/src/main/java/com/utssdk/linphone/LinphoneBridge.kt#L102-L104) → `LinphoneManager.answer` (uni_modules/utssdk/app-android/src/main/java/com/utssdk/linphone/LinphoneManager.kt#L82-L88). |
| `sendDtmf` | `sendDtmf(tone: string): void` | ✅ | ✅ | iOS: `LinphoneBridge.sendDtmf` (uni_modules/utssdk/app-ios/src/LinphoneBridge.swift#L93-L95) → `LinphoneManager.sendDtmf` (uni_modules/utssdk/app-ios/src/LinphoneManager.swift#L102-L109).<br>Android: `LinphoneBridge.sendDtmf` (uni_modules/utssdk/app-android/src/main/java/com/utssdk/linphone/LinphoneBridge.kt#L107-L109) → `LinphoneManager.sendDtmf` (uni_modules/utssdk/app-android/src/main/java/com/utssdk/linphone/LinphoneManager.kt#L98-L104). |
| `sendMessage` | `sendMessage(recipient: string, text: string): void` | ✅ | ✅ | iOS: `LinphoneBridge.messageSend` (uni_modules/utssdk/app-ios/src/LinphoneBridge.swift#L97-L99) → `LinphoneManager.sendMessage` (uni_modules/utssdk/app-ios/src/LinphoneManager.swift#L113-L124).<br>Android: `LinphoneBridge.messageSend` (uni_modules/utssdk/app-android/src/main/java/com/utssdk/linphone/LinphoneBridge.kt#L112-L114) → `LinphoneManager.sendMessage` (uni_modules/utssdk/app-android/src/main/java/com/utssdk/linphone/LinphoneManager.kt#L107-L115). TODO: messaging still mocked. |
| `setAudioRoute` | `setAudioRoute(route: AudioRoute): void` | ✅ | ✅ | iOS: `LinphoneBridge.audioSetRoute` (uni_modules/utssdk/app-ios/src/LinphoneBridge.swift#L101-L112) uses `AudioRouter.setRoute` (uni_modules/utssdk/app-ios/src/AudioRouter.swift#L17-L53) and notifies via `LinphoneManager.updateAudioRoute` (uni_modules/utssdk/app-ios/src/LinphoneManager.swift#L127-L132).<br>Android: `LinphoneBridge.audioSetRoute` (uni_modules/utssdk/app-android/src/main/java/com/utssdk/linphone/LinphoneBridge.kt#L117-L131) uses `AudioRouter.applyRoute` (uni_modules/utssdk/app-android/src/main/java/com/utssdk/linphone/AudioRouter.kt#L22-L61) and `LinphoneManager.updateAudioRoute` (uni_modules/utssdk/app-android/src/main/java/com/utssdk/linphone/LinphoneManager.kt#L119-L123). |
| `addEventListener` | `addEventListener(eventName: string, handler: EventHandler): void` | ✅ | ✅ | UTS listener registry lives in `index.uts` (uni_modules/utssdk/utssdk/index.uts#L217-L225).<br>iOS: `LinphoneBridge.setEventCallback` & `clearEventCallback` (uni_modules/utssdk/app-ios/src/LinphoneBridge.swift#L65-L71) forward native events.<br>Android: `LinphoneBridge.setEventCallback` / `setEventListener` / `clearEventCallback` (uni_modules/utssdk/app-android/src/main/java/com/utssdk/linphone/LinphoneBridge.kt#L67-L79) deliver callbacks. |
| `removeEventListener` | `removeEventListener(eventName: string, handler: EventHandler): void` | ✅ | ✅ | UTS removal logic with bridge teardown is in `index.uts` (uni_modules/utssdk/utssdk/index.uts#L227-L248).<br>iOS: `LinphoneBridge.clearEventCallback` (uni_modules/utssdk/app-ios/src/LinphoneBridge.swift#L69-L71) is invoked when listeners drop to zero.<br>Android: `LinphoneBridge.clearEventCallback` / `setEventListener(null)` (uni_modules/utssdk/app-android/src/main/java/com/utssdk/linphone/LinphoneBridge.kt#L67-L79) handle teardown. |

## Event callbacks

| Event | Payload signature | iOS | Android | Notes |
| --- | --- | --- | --- | --- |
| `permission` | `{ resource: string, status: 'granted' | 'denied' }` | ✅ | ✅ | iOS: emitted during `initialize` when microphone permission is evaluated (uni_modules/utssdk/app-ios/src/LinphoneBridge.swift#L33-L55).<br>Android: emitted from `initialize` after `ensureMicrophonePermission` (uni_modules/utssdk/app-android/src/main/java/com/utssdk/linphone/LinphoneBridge.kt#L33-L56). TODO: Android still needs active permission request flow (see `ensureMicrophonePermission` #L134-L145). |
| `registration` | `{ state: string, message?: string }` | ✅ | ✅ | iOS: initial `initialize` event and `LinphoneManager.didUpdateRegistration` (uni_modules/utssdk/app-ios/src/LinphoneBridge.swift#L58-L62 & #L158-L164).<br>Android: `LinphoneBridge.initialize` and `onRegistrationStateChanged` (uni_modules/utssdk/app-android/src/main/java/com/utssdk/linphone/LinphoneBridge.kt#L58-L63 & #L168-L174). |
| `call` | `{ state: string, ...callContext }` | ✅ | ✅ | iOS: `LinphoneManager.didUpdateCall` propagates call states (uni_modules/utssdk/app-ios/src/LinphoneBridge.swift#L166-L170).<br>Android: `onCallStateChanged` forwards call information (uni_modules/utssdk/app-android/src/main/java/com/utssdk/linphone/LinphoneBridge.kt#L176-L180). |
| `message` | `{ direction: 'outgoing' | string, to?: string, text?: string, ... }` | ✅ | ✅ | iOS: message payload emitted via `LinphoneManager.didReceiveMessage` (uni_modules/utssdk/app-ios/src/LinphoneBridge.swift#L172-L174).<br>Android: emitted by `onMessage` (uni_modules/utssdk/app-android/src/main/java/com/utssdk/linphone/LinphoneBridge.kt#L182-L184). TODO: actual Linphone messaging bridge pending. |
| `audioRoute` | `{ route: 'system' | 'speaker' | 'earpiece' | 'bluetooth' }` | ✅ | ✅ | iOS: emitted after routing via `audioSetRoute` and delegate callback (uni_modules/utssdk/app-ios/src/LinphoneBridge.swift#L101-L112 & #L176-L179).<br>Android: emitted by `audioSetRoute` and `onAudioRoute` (uni_modules/utssdk/app-android/src/main/java/com/utssdk/linphone/LinphoneBridge.kt#L117-L131 & #L186-L188). |
| `error` | `{ category: string, message: string }` | ✅ | ✅ | iOS: `emitError` packages NSError details (uni_modules/utssdk/app-ios/src/LinphoneBridge.swift#L144-L154) and is driven by delegate failures (uni_modules/utssdk/app-ios/src/LinphoneBridge.swift#L182-L184) and permission denial (#L37-L48).<br>Android: `emitError` / `onError` propagate failures (uni_modules/utssdk/app-android/src/main/java/com/utssdk/linphone/LinphoneBridge.kt#L154-L192). |

## Constants

| Constant | Signature | iOS | Android | Notes |
| --- | --- | --- | --- | --- |
| `AudioRoutes` | `const AudioRoutes: Record<string, AudioRoute>` | ✅ | ✅ | Defined in UTS at uni_modules/utssdk/utssdk/index.uts#L108-L113.<br>iOS: `AudioRoute` enum mirrors the same string values (uni_modules/utssdk/app-ios/src/AudioRouter.swift#L4-L11).<br>Android: `AudioRouter.Route` enum exposes matching wire names (uni_modules/utssdk/app-android/src/main/java/com/utssdk/linphone/AudioRouter.kt#L9-L19). |

## Additional notes

- Android’s native bridge signature for `initialize` takes a `Context`; the UniApp runtime supplies it when invoking the plugin, so the UTS surface retains the simpler `init(config)` signature.
- Microphone permission handling on Android currently only checks for an existing grant (see `ensureMicrophonePermission`), while iOS prompts; both sides should be revisited once the real Linphone SDK is wired in.
- The stubbed `LinphoneManager` implementations simulate call/message state transitions; replace them with actual SDK integrations to move these APIs from prototype to production-ready status.
